<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Bond Builder ‡πÄ‡∏Å‡∏°‡πÄ‡∏Ñ‡∏°‡∏µ</title>
  <style>
    body {
      font-family: "Comic Sans MS", sans-serif;
      background: linear-gradient(to right, #d1f7ff, #fff4d1);
      text-align: center;
      margin: 0;
      padding: 0;
    }

    header {
      background: #4cafef;
      color: white;
      padding: 15px;
      font-size: 22px;
      font-weight: bold;
    }

    #game-area {
      margin-top: 20px;
    }

    .atom {
      display: inline-block;
      font-size: 40px;
      cursor: grab;
      margin: 10px;
      padding: 10px;
    }

    #drop-zone {
      border: 2px dashed #555;
      border-radius: 15px;
      width: 80%;
      height: 200px;
      margin: 20px auto;
      padding: 10px;
      background: #f9f9f9;
    }

    #drop-zone .atom-placed {
      font-size: 28px;
      margin: 5px;
      display: inline-block;
    }

    #status {
      font-size: 18px;
      margin: 15px;
      font-weight: bold;
    }

    #score {
      font-size: 20px;
      color: darkgreen;
      font-weight: bold;
    }

    .button {
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 18px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 15px;
      display: none;
    }

    .button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>
  <header>üß™ Bond Builder ‚Äì ‡πÄ‡∏Å‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏•</header>

  <div id="game-area">
    <p>‚ú® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏•: <span id="target"></span></p>
    <div id="atoms">
      <div class="atom" draggable="true" data-atom="H" data-symbol="üíß H">üíß H</div>
      <div class="atom" draggable="true" data-atom="O" data-symbol="üå¨Ô∏è O">üå¨Ô∏è O</div>
      <div class="atom" draggable="true" data-atom="C" data-symbol="üî• C">üî• C</div>
      <div class="atom" draggable="true" data-atom="N" data-symbol="üçÉ N">üçÉ N</div>
    </div>

    <div id="drop-zone">‡∏•‡∏≤‡∏Å‡∏≠‡∏∞‡∏ï‡∏≠‡∏°‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà üß©</div>

    <p id="status"></p>
    <p id="score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</p>

    <button id="checkBtn" class="button" onclick="checkAnswer()">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ‚úÖ</button>
    <button id="nextBtn" class="button" onclick="nextQuestion()">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà ‚ñ∂</button>
  </div>

  <script>
    const molecules = [
      { name: "‡∏ô‡πâ‡∏≥", formula: { H: 2, O: 1 } },   // H2O
      { name: "‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡πÑ‡∏î‡∏≠‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå", formula: { C: 1, O: 2 } }, // CO2
      { name: "‡∏°‡∏µ‡πÄ‡∏ó‡∏ô", formula: { C: 1, H: 4 } }, // CH4
      { name: "‡πÅ‡∏≠‡∏°‡πÇ‡∏°‡πÄ‡∏ô‡∏µ‡∏¢", formula: { N: 1, H: 3 } } // NH3
    ];

    let currentMolecule = {};
    let dropAtoms = [];
    let score = 0;

    const targetEl = document.getElementById("target");
    const dropZone = document.getElementById("drop-zone");
    const statusEl = document.getElementById("status");
    const scoreEl = document.getElementById("score");
    const checkBtn = document.getElementById("checkBtn");
    const nextBtn = document.getElementById("nextBtn");

    function renderDropZone() {
      if (dropAtoms.length === 0) {
        dropZone.innerHTML = "‡∏•‡∏≤‡∏Å‡∏≠‡∏∞‡∏ï‡∏≠‡∏°‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà üß©";
      } else {
        dropZone.innerHTML = "";
        dropAtoms.forEach(a => {
          let span = document.createElement("span");
          span.className = "atom-placed";
          span.textContent = a.symbol;
          dropZone.appendChild(span);
        });
      }
    }

    function nextQuestion() {
      dropAtoms = [];
      renderDropZone();
      statusEl.textContent = "";
      nextBtn.style.display = "none";
      checkBtn.style.display = "inline-block";

      currentMolecule = molecules[Math.floor(Math.random() * molecules.length)];
      targetEl.textContent = `${currentMolecule.name} (${formulaToString(currentMolecule.formula)})`;
    }

    function formulaToString(formula) {
      let str = "";
      for (let atom in formula) {
        str += atom + (formula[atom] > 1 ? formula[atom] : "");
      }
      return str;
    }

    function checkAnswer() {
      let counts = {};
      dropAtoms.forEach(a => counts[a.atom] = (counts[a.atom] || 0) + 1);

      let correct = true;
      for (let atom in currentMolecule.formula) {
        if (counts[atom] !== currentMolecule.formula[atom]) {
          correct = false;
        }
      }
      // ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏∞‡∏ï‡∏≠‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡∏°‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      for (let atom in counts) {
        if (!(atom in currentMolecule.formula)) {
          correct = false;
        }
      }

      if (correct) {
        statusEl.textContent = "‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å üéâ";
        statusEl.style.color = "green";
        score += 10;
        nextBtn.style.display = "inline-block";
        checkBtn.style.display = "none";
      } else {
        statusEl.textContent = "‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞";
        statusEl.style.color = "red";
      }
      scoreEl.textContent = "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: " + score;
    }

    document.querySelectorAll(".atom").forEach(atom => {
      atom.addEventListener("dragstart", e => {
        e.dataTransfer.setData("atom", e.target.dataset.atom);
        e.dataTransfer.setData("symbol", e.target.dataset.symbol);
      });
    });

    dropZone.addEventListener("dragover", e => {
      e.preventDefault();
    });

    dropZone.addEventListener("drop", e => {
      e.preventDefault();
      let atom = e.dataTransfer.getData("atom");
      let symbol = e.dataTransfer.getData("symbol");
      dropAtoms.push({ atom, symbol });
      renderDropZone();
    });

    nextQuestion();
  </script>
</body>
</html>
